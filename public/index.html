<!DOCTYPE html>
<html>

<head>
  <title>Compound Game</title>

  <!-- UIkit CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.6.17/dist/css/uikit.min.css" />
  <!--  Custom CSS     -->
  <link rel="stylesheet" href="./main.css" />

  <!-- UIkit JS -->
  <script src="https://cdn.jsdelivr.net/npm/uikit@3.6.17/dist/js/uikit.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/uikit@3.6.17/dist/js/uikit-icons.min.js"></script>

  <script src="./javascript/colorPicker.js" defer></script>
  <script src="./javascript/canvas.js" defer></script>
</head>

<body>
  <svg style="position: absolute; width: 0; height: 0; overflow: hidden" xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
      <symbol id="icon-paintbrush" viewBox="0 0 20 20">
        <path
          d="M1.384 16.647c0 0-0.675 2.080-1.384 2.807 0 0 0.212 0.224 0.758 0.544 0 0 1.402-1.449 2.155-1.963 0 0.001-0.217-1.692-1.528-1.388z">
        </path>
        <path
          d="M18.988 2.545c-2.452-4.682-6.469-1.471-6.469-1.471 5.353 1.57 4.618 8.168 4.618 8.168 4.135-2.452 1.851-6.697 1.851-6.697z">
        </path>
        <path
          d="M8.832 12.031c1.27-1.632 7.594-5.629 7.602-5.634-0.274-0.744-0.592-1.355-0.933-1.858-1.752 0.738-8.301 6.189-8.301 6.189 2.329-3.11 7.583-7.055 7.592-7.061-1.702-1.73-3.61-1.417-3.61-1.417-3.204 2.925-7.31 7.898-8.855 9.809-0.195 0.223-0.404 0.483-0.627 0.781 0 0 1.788-1.477 2.372-0.756 0.585 0.722 0.412 2.166 0.412 2.166s1.169-1.477 1.857-0.722c0.687 0.756 0.24 1.788 0 2.062 0 0 0.996-0.997 1.203-0.618 0.206 0.378 0.034 1.237-0.585 2.027 0 0 0.114-0.132 0.273-0.336 4.732-5.805 9.907-7.419 9.907-7.419-0.104-0.685-0.236-1.303-0.389-1.862-2.36 0.969-7.917 4.651-7.917 4.651z">
        </path>
        <path
          d="M7.148 15.589c-0.035-0.274-0.808 0-0.808 0 0.12-0.274-0.052-1.013-0.378-1.425s-1.478 0.086-1.478 0.086c0-0.345-0.464-1.22-0.979-1.581-0.514-0.36-1.805 0.172-1.805 0.172 0.224 1.942-0.316 3.808-0.316 3.808 2.736-1.033 1.528 1.39 1.528 1.39 1.805-1.064 4.046-1.039 4.046-1.039 0.516-0.878 0.19-1.41 0.19-1.41z">
        </path>
      </symbol>
      <symbol id="icon-undo" viewBox="0 0 19 20">
        <path
          d="M11.864 16.206c-3.311 1.617-7.112 0.638-8.491-2.185-1.281-2.623-0.021-5.912 2.815-7.664 0.926 1.626 1.742 2.93 1.919 2.93 0.459 0 3.172-6.964 3.044-7.477s-7.839-2.136-8.074-1.752c-0.089 0.146 0.559 1.532 1.417 3.184-4.014 2.657-5.646 7.684-3.628 11.814 2.211 4.522 7.956 6.257 12.837 3.873 0.944-0.461 1.783-1.043 2.512-1.714l-2.049-2.731c-0.621 0.683-1.394 1.277-2.301 1.72z">
        </path>
        <path
          d="M15.811 11.077c-0.082 0.596-0.263 1.186-0.531 1.752l2.574 2.45c0.608-0.935 1.049-1.957 1.3-3.012l-3.343-1.189z">
        </path>
      </symbol>
    </defs>
  </svg>

  <div id='initial-screen'>
    <h1>Compound Game</h1>

    <div class="buttons">
      <input type='text' placeholder="Enter Player Name" id='nameInput' />
      <br><br>
      <button onclick="createButtonClicked()">CREATE</button>
      <div>OR</div>
      <div>
        <input type='text' placeholder='Enter Room Id' id='roomIdInput' />
        <button onclick="joinButtonClicked()">JOIN</button>
      </div>
    </div>
  </div>

  <div id='waiting-room-host' style="display:none">
    <h1>Compound Game Waiting Room</h1>
    <p id="gameId"> </p>
    <h2> Game room ID: <input id="gameCodeDisplay" readonly="readonly"></input><button id="copy-room-code"
        onclick="copyLobbyId()">Click to copy</button></h2>
    <p id='userJoin'> </p>
    <input type='text' placeholder='Max Players' id='MaxPlayerInput' class="uk-input" />
    <input type='text' placeholder='Number of Rounds' id='RoundInput' />
    <input type='text' placeholder='Round Timer' id='RoundTimerInput' />


    <button onclick='startGameButtonClicked()'>Start Game</button>
    <p id='playerJoin2'></p> <!-- TODO: Add whatever happens to playerJoin? -->

  </div>

  <div id='waiting-room-player' style="display:none">
    <h1>Compound Game Waiting Room</h1>
    <p id='displayRoom'></p>
    <p id='playerJoin'></p>
  </div>

  <div id='example' style="display:none">
    <h3>Example</h3>
  </div>

  <!--     Guesser's view  -->
  <div id="guesser-view" style="display:none">
    <div class="uk-section uk-section-default uk-height-viewport uk-text-large">
      <div class="uk-container">
        <div class="uk-child-width-expand uk-grid" uk-grid="masonry: true">
          <div class="uk-width-1-1 uk-heading-large uk-text-center uk-background-primary" style="height: 80px">
            Doodle Duo
          </div>
          <div class="uk-width-1-2" style="height: 100vw">
            <div class="uk-height-1-1 uk-cover-container">
              <div id="guesserCanvas1"
                class="uk-cover uk-border-rounded uk-background-muted uk-height-1-1 uk-width-1-1">
                Canvas 1
                <canvas id="guesscanvas-1" width="200" height="400"></canvas>
              </div>
            </div>
          </div>
          <div class="uk-width-1-2" style="height: 100vw">
            <div class="uk-height-1-1 uk-cover-container">
              <div id="guesserCanvas2"
                class="uk-cover uk-border-rounded uk-background-muted uk-height-1-1 uk-width-1-1">
                Canvas 2
                <canvas id="guesscanvas-2" width="200" height="400"></canvas>
              </div>
            </div>
          </div>
          <div style="width: 100%; display: flex; flex-direction: row">
            <div style="width: 50%">
              <div id="nameDrawing1" class="uk-text-center"></div>
            </div>
            <div style="width: 50%">
              <div id="nameDrawing2" class="uk-text-center"></div>
            </div>
          </div>

          <div class="uk-width-1-1" style="height: 80px">
            <div class="uk-height-1-1 uk-cover-container uk-align-center">
              <div class="uk-cover uk-flex uk-flex-row large-text uk-border-rounded uk-background-muted uk-height-1-1">
                <span id="spacesDisplay"></span>
              </div>
              <div>
                <div id="timeRemaining">Time Remaining:</div>
                <span id="gameTimeDisplay"></span>
              </div>
            </div>
          </div>
          <div class="uk-width-1-2 uk-align-center" style="height: 80px">
            <div class="uk-inline">
              <input class="uk-input uk-box-shadow" placeholder="Input your Guess" id="GuessInput">
              <a class="uk-form-icon uk-form-icon-flip" onclick="guessInputHandler()" uk-icon="icon: pencil"></a>
            </div>
          </div>
          <div class="uk-width-1-1 uk-align-center uk-height-large" style="width: 50vw">
            <div class="uk-align-center">
              <div class="chat-box-container">
                <ul id="chat-box-guesser" class="chat-box"></ul>
              </div>

              <!--    Scoreboard    -->
<!--              style="display:none" -->
              <div class="scoreboard-container" id="scoreboard">
                <div class="score-container">
                  <ul id="score" class="score-box"></ul>
                  <b id='correct-ans'></b>
                  <table id='score-table'>
                    <tr>
                      <th>Rank</th>
                      <th>Player</th>
                      <th>Points</th>
                    </tr>
                    <tbody id= 'tbody'>

                    </tbody>
                  </table>
                  <b id='winner'></b>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--     Drawer's view  -->
  <div style="display:none" id="drawer-view">
    <div class="uk-section uk-section-default uk-height-viewport uk-text-large">
      <div class="uk-container">
        <div class="uk-child-width-expand uk-grid" uk-grid="masonry: true">
          <div class="uk-width-1-1 uk-heading-large uk-text-center header" style="height: 80px">
            Doodle Duo
          </div>
          <div class="uk-width-1-6 uk-background-muted" style="height: 120vw">
            <div class="uk-flex-column uk-flex">
              <div class="undoButtonContainer center-content" aria-label="undo">
                <svg class="icon icon-undo">
                  <use xlink:href="#icon-undo"></use>
                </svg>
              </div>
              <div class="paintButtonContainer center-content" aria-label="draw">
                <svg class="icon icon-paintbrush">
                  <use xlink:href="#icon-paintbrush"></use>
                </svg>
              </div>
              <div class="colorPickerContainer">
                <h2 id="color-choice"></h2>
                <input class="color-range" type="range" min="0" max="100" value="75" title="Drag me to select.">
              </div>
              <input type="range" min=1 max=50 id="brush-size" value="5">
              <button id="clear-canvas">Clear canvas</button>
              <button id="undo-button">Undo button</button>
            </div>
          </div>
<!--          id="gCanvas-wrapper"-->
          <div class="uk-width-2-3"  style="height: 120vw" >
            <div class="uk-height-1-1 uk-cover-container">
              <div class="uk-cover uk-margin-auto uk-border-rounded uk-background-muted uk-height-1-1 uk-width-1-1">
                <canvas id="canvas-1" width="200" height="400"></canvas>
              </div>
            </div>
          </div>
          <div class="uk-width-1-1" style="height: 100px">
            <div class="uk-height-1-1 uk-cover-container uk-align-center">
              <div class="uk-cover uk-flex uk-flex-row large-text uk-border-rounded uk-background-muted uk-height-1-1">
                <div id="wordToDraw" class="uk-margin-small-left">
                  ERROR
                </div>
              </div>
              <div>
                <div>Time Remaining:</div>
                <span id="dGameTimeDisplay"></span>
              </div>
            </div>
          </div>
          <div class="uk-width-1-1 uk-align-center uk-height-medium" style="width: 50vw">
            <div class="uk-align-center uk-flex uk-flex-column">
              <div class="chat-box-container">
                <ul id="chat-box-drawer" class="chat-box"></ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<!--  &lt;!&ndash;    Scoreboard    &ndash;&gt;-->
<!--  <div style="display:none" id="scoreboard">-->
<!--    <div class="uk-width-1-1 uk-align-center uk-height-large" style="width: 50vw">-->
<!--      <div class="uk-align-center">-->
<!--        <div class="score-container">-->
<!--          <ul id="score" class="score-box"></ul>-->
<!--          <b id='correct-ans'></b>-->
<!--          <table id='score-table'>-->
<!--            <tr>-->
<!--              <th>Rank</th>-->
<!--              <th>Player</th>-->
<!--              <th>Points</th>-->
<!--            </tr>-->
<!--            <tbody id= 'tbody'>-->
<!--  -->
<!--            </tbody>-->
<!--          </table>-->
<!--          <b id='winner'></b>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

  <script src="/socket.io/socket.io.js"></script>

  <!--initialize socket object so clients can establish connections-->
  <script>
    /** ~~~~~~~~~~~~~~~~~~~~~~~~~~~ Global Variables ~~~~~~~~~~~~~~~~~~~~~~~~~~~  **/
    const socket = io();
    var drawerNumber = 0;


    /** ~~~~~~~~~~~~~~~~~~~~~~~~~~~ HTML Element Definitions ~~~~~~~~~~~~~~~~~~~~~~~~~~~  **/
    // Object containing all possible views
    const allViews = {
      initialScreen: document.getElementById('initial-screen'),
      waitingRoomForHost: document.getElementById('waiting-room-host'),
      waitingRoomForPlayer: document.getElementById('waiting-room-player'),
      example: document.getElementById('example'),
      guesserView: document.getElementById('guesser-view'),
      drawerView: document.getElementById('drawer-view'),
      // scoreboard: document.getElementById('scoreboard')
    };

    // Initial screen room input
    const roomInput = document.getElementById('roomIdInput');
    // Initial screen name input
    const nameInput = document.getElementById('nameInput');

    // Game code display and copy button from host waiting room
    const gameCodeDisplay = document.getElementById('gameCodeDisplay');
    const copyRoomCodeButton = document.getElementById('copy-room-code');
    // Lobby number display from player waiting room
    const displayRoom = document.getElementById('displayRoom');
    // Game rule inputs from host waiting room
    const maxPlayer = document.getElementById('MaxPlayerInput');
    const roundInput = document.getElementById('RoundInput');
    const roundTimer = document.getElementById('RoundTimerInput');
    // Player join notification divs from waiting rooms
    const playerJoinNotifications = getElementsById('playerJoin playerJoin2');

    const spaces = document.getElementById('spacesDisplay');
    // Chat boxes from guesser and drawer views
    const chatContainers = document.getElementsByClassName('chat-box-container');
    const chatBoxes = document.getElementsByClassName('chat-box');
    // Game time displays from guesser and drawer views
    const gameTimeDisplays = getElementsById('gameTimeDisplay dGameTimeDisplay');
    // Chat input box from guesser view
    const guessInputBox = document.getElementById('GuessInput');
    // Canvas username tags from drawer view
    const nameDrawing1 = document.getElementById('nameDrawing1');
    const nameDrawing2 = document.getElementById('nameDrawing2');
    // Word to draw div from drawer view
    const wordToDraw = document.getElementById('wordToDraw');

    //ul which stores scoreboard information
    const scores = document.getElementById('score');
    const scoreBoard = document.getElementById('score-box');
    const correctAns = document.getElementById('correct-ans');
    const scoreTable = document.getElementById('score-table');
    const winner = document.getElementById('winner');
    const tableBody = document.getElementById('tbody');

    // scoreboard wrapper that replaces the chatbox at the end of the round
    const scoreboard = document.getElementById('scoreboard');


    /** ~~~~~~~~~~~~~~~~~~~~~~~~~~~ Utility Functions ~~~~~~~~~~~~~~~~~~~~~~~~~~~  **/
    /**
     * Returns whether a given HTML element is scrolled to within 10px of the bottom
     */
    const isScrolledNearBottom = el =>
      el.scrollTop + 10 >= el.scrollHeight - el.clientHeight;

    /**
     * Scrolls given HTML element to the bottom
     */
    const scrollToBottom = el =>
      el.scrollTop = el.scrollHeight - el.clientHeight;

    /**
     * This function enables us to get multiple elements by id and treat them like one
     * Particularly helpful in updating identical things in the drawer and guesser view
     * use like this:
     * const gameTimeDisplay = getElementsById('gameTimeDisplay dGameTimeDisplay');
     * (without this function we'd have to have 2 different assignments like this:
     * const gameCodeDisplay = document.getElementById('gameCodeDisplay'); //
     */
    function getElementsById(ids) {
      const idList = ids.split(' ');
      let results = [], item;
      for (let i = 0; i < idList.length; i++) {
        item = document.getElementById(idList[i]);
        if (item) {
          results.push(item);
        }
      }
      return (results);
    }

    /**
     * Posts a message to all chatboxes, and scrolls them if they are already scrolled
     * all the way down.
     */
    function postChatMessage(msg, username = null) {
      const elementsToScroll = [];
      for (chatContainer of chatContainers) {
        if (isScrolledNearBottom(chatContainer)) elementsToScroll.push(chatContainer);
      }

      for (chatBox of chatBoxes) {
        const msgLi = document.createElement('li');

        if (username) {
          const usernameB = document.createElement('b');
          usernameB.innerText = username + ": ";
          msgLi.appendChild(usernameB);
        }

        const msgSpan = document.createElement('span');
        msgSpan.innerText = msg;
        msgLi.appendChild(msgSpan);

        chatBox.appendChild(msgLi);
      }

      for (el of elementsToScroll) {
        scrollToBottom(el);
      }
    }

    /**
     * Switches between the different views
     *
     * Pass in the ID of the view to make it display, and all other views
     * will not display.
     */
    function switchToView(newViewName) {
      for (let [viewName, view] of Object.entries(allViews)) {
        if (viewName === newViewName) {
          view.style.display = 'block';
        } else {
          view.style.display = 'none';
        }
      }

      // Specialized view behaviors
      switch (newViewName) {
        case "guesserView":
        case "drawerView":
          for (chatContainer of chatContainers) scrollToBottom(chatContainer);
          break;
      }
    }

    /**
     * Gets the usernames of the two drawers for the current round
     * Takes as input the scores object defined in notes.js
     */
    function getDrawerNames(scores) {
      let drawer1 = 'Drawer 1';
      let drawer2 = 'Drawer 2';
      for (let data of Object.values(scores)) {
        if (data.drawer === 1) {
          drawer1 = data.username;
        } else if (data.drawer === 2) {
          drawer2 = data.username;
        }
      }
      return [drawer1, drawer2];
    }

    /**
     * Resets the values of certain inputs, and sets the view to the initial screen
     */
    function reset() {
      roomInput.value = '';
      gameCodeDisplay.value = '';
      switchToView('initialScreen');
    }


    /** ~~~~~~~~~~~~~~~~~~~~~~~~~~~ Event Handlers ~~~~~~~~~~~~~~~~~~~~~~~~~~~  **/
    /**
     * onclick function for lobby code copy button
     */
    function copyLobbyId() {
      gameCodeDisplay.select();
      gameCodeDisplay.setSelectionRange(0, 99999); //Mobile devices

      document.execCommand('copy');

      copyRoomCodeButton.innerText = 'Copied!';
    }

    /**
     * onclick function for guess input pencil icon
     * onkeyup(enter) for the guess input
     */
    function guessInputHandler() {
      socket.emit('playerGuess', guessInputBox.value);
      guessInputBox.value = '';
    }
    guessInputBox.onkeyup = ({ keyCode }) => {
      if (keyCode === 13) guessInputHandler();
    }

    /**
     * onclick function for create lobby button
     */
    function createButtonClicked() {
      socket.emit('createClicked', nameInput.value);
    }

    /**
     * onclick function for join lobby button
     * onkeyup(enter) for lobby code input
     */
    function joinButtonClicked() {
      switchToView('waitingRoomForPlayer');
      console.debug(`Attempting to join lobby ${roomInput.value} with username ${nameInput.value}`);
      socket.emit('joinClicked', roomInput.value, nameInput.value);
    }
    roomInput.onkeyup = ({ keyCode }) => {
      if (keyCode === 13) joinButtonClicked();
    }

    /**
     * onclick function for start game button
     */
    function startGameButtonClicked() {
      socket.emit('startGame', maxPlayer.value, roundInput.value, roundTimer.value);
    }



    /** ~~~~~~~~~~~~~~~~~~~~~~~~~~~ SocketIO Events ~~~~~~~~~~~~~~~~~~~~~~~~~~~  **/
    socket.on('connect', function () {
      switchToView('initialScreen');
    });

    socket.on('succesfullyCreatedLobby', function (lobbyId) {
      console.debug('succesfullyCreatedLobby', { lobbyId });
      switchToView('waitingRoomForHost');
      gameCodeDisplay.value = lobbyId;
    });

    socket.on('endRoundScores', function (scoresObj, ans) {
      console.debug('endRoundScores', {scoresObj, ans});
      console.log(scoresObj)
      switchToView('guesserView');
      chatBoxes.style.display = 'none';
      scoreboard.style.display = 'block';


      correctAns.innerText = 'The correct answer is: '+ ans;
      //myScoreList.sort(function (a,b) {return a.score - b.score} )

      ranklist = [];
      for (var player in scoresObj){
        var playerObj = scoresObj[player];
        ranklist.push(playerObj);
      }

      ranklist.sort(function (a,b) {return b.score - a.score});

      console.log(ranklist);
      console.log('ranklist: '+ ranklist.sort(function (a,b) {return b.score - a.score} )[0].score);
      tableBody.innerHTML = '';
      for (var i = 0; i<ranklist.length; i++){
        const addCell = document.createElement('tr');
        tableBody.appendChild(addCell);

        const rank = document.createElement('td');
        rank.innerText = (i+1);
        const playerUsername = document.createElement('td');
        playerUsername.innerText = ranklist[i].username;
        const points = document.createElement('tr');
        points.innerText = ranklist[i].score + '(+'+ ranklist[i].gained+' points)';

        addCell.appendChild(rank);
        addCell.appendChild(playerUsername);
        addCell.appendChild(points);
      }

      console.debug('endRoundScores', { scoresObj });
    });

    socket.on('errorRoomId', function () {
      console.debug('errorRoomId');
      reset();
      alert('Unknown game code');
    });

    socket.on('tooManyPlayers', function () {
      console.debug('tooManyPlayers');
      reset();
      alert('Room full');
    });

    socket.on('tooFewPlayers', function () {
      console.debug('tooFewPlayers');
      //reset();
      alert('We recommend a minimum of four players to play this game');
    });

    socket.on('drawerView', function (scores, data) {
      console.debug('drawerView', { scores, data });
      drawerNumber = data.drawer;
      switchToView('drawerView');
      // let height = document.getElementById('gCanvas-wrapper').offsetHeight;
      // document.getElementById('gCanvas-wrapper').style.width = (height/2).toString();

      drawingEvents = []
      ctx1.clearRect(0, 0, canvas1.width, canvas1.height);
      wordToDraw.innerText = data.word;
    });

    socket.on('guesserView', function (scores, data) {
      console.debug('guesserView', { scores, data });
      switchToView('guesserView');
      scoreboard.style.display = 'none';
      gctx1.clearRect(0, 0, guesscanvas1.width, guesscanvas1.height);
      gctx2.clearRect(0, 0, guesscanvas2.width, guesscanvas2.height);
      let spacesLength = data.word1Length + data.word2Length;
      let spacesDisplay = ' __'.repeat(spacesLength).slice(1); //slice(1) cuts off the leading space
      console.log(spacesDisplay);
      spaces.innerText = spacesDisplay;
      let drawerNames = getDrawerNames(scores);

      nameDrawing1.innerText = 'Doodler: ' + drawerNames[0];
      nameDrawing2.innerText = 'Doodler: ' + drawerNames[1];
    });

    socket.on('timerUpdate', function (timeLeft) {
      console.debug('timerUpdate', timeLeft);
      for (let timerElement of gameTimeDisplays) {
        timerElement.innerText = timeLeft + ' seconds';
      }
    });

    socket.on('gameOverEvent', function (scoresObj,ans) {
      switchToView('drawerView');
      // maybe we don't need this?
      if (chatContainers) {
        chatContainers.style.display = 'none';
      }
      scoreboard.style.display = 'block';
      // chatBoxes.style.display = 'none';
      spaces.innerText = ans;
      correctAns.innerText = 'The correct answer is: '+ ans;
      //myScoreList.sort(function (a,b) {return a.score - b.score} )

      ranklist = [];
      for (var player in scoresObj){
        var playerObj = scoresObj[player];
        ranklist.push(playerObj);
      }

      ranklist.sort(function (a,b) {return b.score - a.score});

      console.log(ranklist);
      console.log('ranklist: '+ ranklist.sort(function (a,b) {return b.score - a.score} )[0].score);
      tableBody.innerHTML = '';
      for (var i = 0; i<ranklist.length; i++){
        const addCell = document.createElement('tr');
        tableBody.appendChild(addCell);

        const rank = document.createElement('td');
        rank.innerText = (i+1);
        const playerUsername = document.createElement('td');
        playerUsername.innerText = ranklist[i].username;
        const points = document.createElement('tr');
        points.innerText = ranklist[i].score + '(+'+ ranklist[i].gained+' points)';

        addCell.appendChild(rank);
        addCell.appendChild(playerUsername);
        addCell.appendChild(points);
      }
      winner.innerText = 'THE WINNER IS '+ ranklist[0].username+'!!!'
      console.debug('gameOverEvent', { scoresObj });
    });

    //sent to the specific user when they guess right
    socket.on('correctGuess', function (word) {
      console.debug('correctGuess');
      spaces.innerText = word; // reveal the word

      postChatMessage('You guessed it!');
    });

    socket.on('someoneGuessed', function (gameState, socketId, username) {
      console.debug('someoneGuessed', { gameState, socketId, username });
      postChatMessage(username + '  has correctly guessed the compound word!');
    });

    socket.on('closeGuess', function () {
      console.debug('closeGuess');
      postChatMessage('Your guess was close...');
    });

    socket.on('wrongGuess', function (playerGuess, socketId, username) {
      console.debug('wrongGuess', { playerGuess, socketId });
      postChatMessage(playerGuess, username);
    });

    socket.on('broadcastJoined', function (username) {
      console.debug('broadcastJoined', { username });

      for (el of playerJoinNotifications) {
        el.appendChild(document.createElement('br'));
        el.appendChild(document.createTextNode(username + '  has joined! \n'));
      }
    });

    socket.on('waitingRoomForPlayer', function (roomId) {
      console.debug('waitingRoomForPlayer', { roomId });
      switchToView('waitingRoomForPlayer');
      displayRoom.innerText = 'You are in room ' + roomId + '! Waiting for host to start game...';
    });

    socket.on('drawingUpdate', function (drawingEvents, drawNum) {
      //console.log('drawingUpdate Client');
      if(drawNum == 1){
        for (let i = 0; i < drawingEvents.length; i++) {
          handleDrawingEvent1(drawingEvents[i]);
        }
      }
      else if(drawNum == 2){
        for (let i = 0; i < drawingEvents.length; i++) {
          handleDrawingEvent2(drawingEvents[i]);
        }
      }

    });
    socket.on('undoEvent', function (drawingEvents, drawNum) {
      //console.log('drawingUpdate Client');
      if(drawNum == 1){
        gctx1.clearRect(0, 0, guesscanvas1.width, guesscanvas1.height);
        gctx1.beginPath();
        for (let i = 0; i < drawingEvents.length; i++) {
          handleDrawingEvent1(drawingEvents[i]);
        }
        gctx1.stroke();

        updateColor();
        updateWidth();
      }
      else if(drawNum == 2){
        gctx2.clearRect(0, 0, guesscanvas2.width, guesscanvas2.height);
        gctx2.beginPath();
        for (let i = 0; i < drawingEvents.length; i++) {
          handleDrawingEvent2(drawingEvents[i]);
        }
        gctx2.stroke();

        updateColor();
        updateWidth();
      }

    });

    socket.on('clearEvent', function (drawingEvents, drawNum) {
      //console.log('drawingUpdate Client');
      if(drawNum == 1){
        gctx1.clearRect(0, 0, guesscanvas1.width, guesscanvas1.height);
      }
      else if(drawNum == 2){
        gctx2.clearRect(0, 0, guesscanvas2.width, guesscanvas2.height);
      }

    });
  </script>

</body>

</html>
